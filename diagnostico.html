<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <title>Diagn√≥stico Traducciones</title>
    <style>
        body { font-family: monospace; padding: 2rem; background: #1a1a1a; color: #0f0; }
        .error { color: #f00; }
        .success { color: #0f0; }
        .warning { color: #ff0; }
        pre { background: #000; padding: 1rem; border-radius: 8px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç Diagn√≥stico del Sistema de Traducciones</h1>
    <div id="output"></div>

    <!-- CARGAR SCRIPTS EN ORDEN -->
    <script src="assets/js/language-switcher.js"></script>
    <script src="assets/js/ecommerce.js"></script>
    
    <script>
        const output = document.getElementById('output');
        const logs = [];
        
        function log(msg, type = 'info') {
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'warning';
            logs.push(`<p class="${className}">${msg}</p>`);
            output.innerHTML = logs.join('');
        }
        
        log('=== INICIANDO DIAGN√ìSTICO ===', 'warning');
        log('');
        
        // Test 1: Verificar carga de languageSwitcher
        log('1. Verificando languageSwitcher...', 'warning');
        if (typeof languageSwitcher !== 'undefined') {
            log('   ‚úÖ languageSwitcher existe', 'success');
            log('   üìç Tipo: ' + typeof languageSwitcher);
            log('   üåê Idioma actual: ' + languageSwitcher.currentLang, 'success');
            log('   üìö Idiomas disponibles: ' + Object.keys(languageSwitcher.translations).join(', '));
        } else {
            log('   ‚ùå ERROR: languageSwitcher NO definido', 'error');
        }
        log('');
        
        // Test 2: Verificar funci√≥n getTranslation
        log('2. Verificando getTranslation()...', 'warning');
        if (typeof getTranslation === 'function') {
            log('   ‚úÖ getTranslation() es una funci√≥n', 'success');
            
            // Probar traducciones
            const tests = {
                'badge.bestseller': 'Myydyin',
                'product.1.name': 'Klassinen Espresso',
                'product.2.name': 'K√§sity√∂ Cappuccino',
                'product.add': 'Lis√§√§',
                'product.details': 'N√§yt√§ tiedot'
            };
            
            log('   üß™ Probando traducciones:', 'warning');
            let allCorrect = true;
            for (const [key, expected] of Object.entries(tests)) {
                const result = getTranslation(key);
                const isCorrect = result === expected;
                if (!isCorrect) allCorrect = false;
                
                log(`      ${key}:`, isCorrect ? 'success' : 'error');
                log(`         Esperado: "${expected}"`, isCorrect ? 'success' : 'warning');
                log(`         Obtenido: "${result}"`, isCorrect ? 'success' : 'error');
                
                if (!isCorrect && result.match(/vendido|agregar|ver detalles/i)) {
                    log('         ‚ö†Ô∏è ¬°TODAV√çA EN ESPA√ëOL!', 'error');
                }
            }
            
            if (allCorrect) {
                log('   üéâ TODAS LAS TRADUCCIONES FUNCIONAN', 'success');
            } else {
                log('   ‚ùå ALGUNAS TRADUCCIONES FALLAN', 'error');
            }
        } else {
            log('   ‚ùå ERROR: getTranslation() NO existe', 'error');
        }
        log('');
        
        // Test 3: Verificar productos
        log('3. Verificando PRODUCTS_DATA...', 'warning');
        if (typeof PRODUCTS_DATA !== 'undefined') {
            log('   ‚úÖ PRODUCTS_DATA existe', 'success');
            log('   üì¶ Productos cargados: ' + PRODUCTS_DATA.length);
            log('   üìù Primer producto: ' + PRODUCTS_DATA[0].name);
        } else {
            log('   ‚ö†Ô∏è PRODUCTS_DATA no cargado a√∫n (es normal)', 'warning');
        }
        log('');
        
        // Test 4: localStorage
        log('4. Verificando localStorage...', 'warning');
        const savedLang = localStorage.getItem('amherkut-language');
        if (savedLang) {
            log('   üìå Idioma guardado: ' + savedLang, savedLang === 'fi' ? 'success' : 'warning');
        } else {
            log('   ‚ö†Ô∏è No hay idioma guardado en localStorage', 'warning');
        }
        log('');
        
        // Test 5: Resumen
        log('=== RESUMEN ===', 'warning');
        if (typeof getTranslation === 'function' && typeof languageSwitcher !== 'undefined') {
            log('‚úÖ El sistema est√° FUNCIONANDO correctamente', 'success');
            log('');
            log('Si ves productos en espa√±ol:', 'warning');
            log('1. El problema es el CACHE del navegador', 'warning');
            log('2. Presiona Ctrl+Shift+R para recarga forzada', 'warning');
            log('3. O ve a F12 > Application > Clear site data', 'warning');
        } else {
            log('‚ùå HAY PROBLEMAS con el sistema', 'error');
            log('   Verifica que language-switcher.js se carga correctamente', 'error');
        }
        
        // Mostrar objeto completo
        log('');
        log('=== OBJETO languageSwitcher ===', 'warning');
        if (languageSwitcher) {
            log('<pre>' + JSON.stringify({
                currentLang: languageSwitcher.currentLang,
                hasTranslations: !!languageSwitcher.translations,
                translationKeys: languageSwitcher.translations ? Object.keys(languageSwitcher.translations) : []
            }, null, 2) + '</pre>');
        }
    </script>
</body>
</html>

